{"remainingRequest":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wuzhanfly/git/filscan-frontend/src/components/BlockList.vue?vue&type=style&index=0&id=94e1156a&lang=scss&scoped=true&","dependencies":[{"path":"/home/wuzhanfly/git/filscan-frontend/src/components/BlockList.vue","mtime":1612684657984},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJsb2NrLWxpc3QgewogIC50b3RhbC1udW1iZXIgewogICAgaGVpZ2h0OiA4MHB4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHBhZGRpbmc6IDAgMTAwcHg7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYmFja2dyb3VuZDogdmFyKC0tYm9hcmQtYmctY29sb3IpOwogICAgY29sb3I6IHZhcigtLW1haW4tdGV4dC1jb2xvcik7CiAgICAmIDo6di1kZWVwID4gc3BhbiB7CiAgICAgIG1hcmdpbi1yaWdodDogYXV0bzsKICAgICAgaSB7CiAgICAgICAgY29sb3I6IHZhcigtLWxpbmstY29sb3IpOwogICAgICAgIGZvbnQtc2l6ZTogMjJweDsKICAgICAgfQogICAgfQogICAgLmVsLWRyb3Bkb3duLWxpbmsgewogICAgICBjb2xvcjogd2hpdGU7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["BlockList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BlockList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"block-list\">\n    <div class=\"table-con\" v-if=\"!isMobile\">\n      <base-table\n        :dataSource=\"blockData\"\n        :columns=\"realColumns\"\n        showPagination\n        :total=\"total\"\n        @size-change=\"handleSizeChange\"\n        @page-change=\"handlePageChange\"\n        :labels=\"realLabels\"\n      >\n        <div class=\"total-number border-bottom\" slot=\"header\">\n          <span\n            v-html=\"\n              $t('component.blockList.total', {\n                total: formatNumber(total),\n                fil: formatNumber(filTotal)\n              })\n            \"\n          ></span>\n        </div>\n      </base-table>\n    </div>\n    <mb-board\n      v-for=\"item in blockData\"\n      :key=\"item.cid\"\n      :dataSource=\"item\"\n      :columns=\"mbColumns\"\n      v-else\n    />\n    <mb-page v-if=\"isMobile\" @page-change=\"handlePageChange\" :total=\"total\" />\n  </div>\n</template>\n<script>\nimport { getBlockByHeight } from \"@/api/tipset\";\nimport { getBlocksByMiner } from \"@/api/account\";\nexport default {\n  name: \"BlockList\",\n  data() {\n    return {\n      loading: false,\n      total: 0,\n      filTotal: 0,\n      option: {\n        begindex: \"0\",\n        count: \"25\",\n        miners: this.miners\n      },\n      blockData: [],\n      columns: [\n        {\n          key: \"height\",\n          isLink: true,\n          target: \"tipset\",\n          hideInMobile: true\n        },\n        {\n          key: \"hash\",\n          isLink: true,\n          target: \"tipset\",\n          ellipsis: true\n        },\n        {\n          key: \"time\"\n        },\n        {\n          key: \"mes\"\n        },\n        {\n          key: \"size\"\n        },\n        {\n          key: \"miner\",\n          isLink: true,\n          target: \"address/detail\",\n          paramKey: \"address\"\n        },\n        {\n          key: \"reward\",\n          unit: \"FIL\"\n        }\n      ]\n    };\n  },\n  props: {\n    hideIndex: {\n      type: Array,\n      default() {\n        return [];\n      }\n    },\n    height: {\n      type: Number,\n      default: 0\n    },\n    miners: {\n      type: Array,\n      default() {\n        return [];\n      }\n    }\n  },\n  computed: {\n    realColumns() {\n      return this.columns.filter((item, index) => {\n        return !this.hideIndex.includes(index);\n      });\n    },\n    realLabels() {\n      return this.$t(\"component.blockList.label\").filter((item, index) => {\n        return !this.hideIndex.includes(index);\n      });\n    },\n    mbColumns() {\n      return this.realColumns\n        .map((item, index) => {\n          return {\n            ...item,\n            title: this.realLabels[index]\n          };\n        })\n        .filter(item => {\n          return !item.hideInMobile;\n        });\n    }\n  },\n  methods: {\n    handleSizeChange(v) {\n      this.option.count = v;\n    },\n    handlePageChange(v) {\n      this.option.begindex = (v - 1) * this.option.count;\n    },\n    async getBlockByHeight() {\n      try {\n        this.loading = true;\n        let data = await getBlockByHeight({\n          height: this.height\n        });\n        const blockData = data.blocks.map(item => {\n          const { height } = item;\n          return {\n            height\n          };\n        });\n        this.total = blockData.length;\n        this.blockData = blockData;\n      } catch (e) {\n        if (e) {\n          this.loading = false;\n        }\n      }\n    },\n    async getBlockByMiner() {\n      try {\n        this.loading = true;\n\n        let data = await getBlocksByMiner(this.option);\n        const dataSource = data.blocks.map(item => {\n          const { block_header, size, reward, cid, msg_cids } = item;\n          const { height, timestamp, miner } = block_header;\n          return {\n            height,\n            hash: cid,\n            time: this.formatTime(timestamp),\n            mes: msg_cids.length,\n            size,\n            miner,\n            reward\n          };\n        });\n        this.blockData = Object.freeze(dataSource);\n        this.total = Number(data.total);\n        this.filTotal = Number(data.total_fil);\n        this.loading = false;\n      } catch (e) {\n        if (e) {\n          this.loading = false;\n        }\n      }\n    }\n  },\n  mounted() {\n    //this.getBlockByMiner();\n  },\n  watch: {\n    height: {\n      immediate: true,\n      handler(v) {\n        if (v) {\n          this.getBlockByHeight();\n        }\n      }\n    },\n    option: {\n      deep: true,\n      immediate: true,\n      handler() {\n        this.getBlockByMiner();\n      }\n    },\n    miners() {\n      this.option = {\n        begindex: \"0\",\n        count: \"25\",\n        miners: this.miners\n      };\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.block-list {\n  .total-number {\n    height: 80px;\n    align-items: center;\n    padding: 0 100px;\n    display: flex;\n    background: var(--board-bg-color);\n    color: var(--main-text-color);\n    & ::v-deep > span {\n      margin-right: auto;\n      i {\n        color: var(--link-color);\n        font-size: 22px;\n      }\n    }\n    .el-dropdown-link {\n      color: white;\n    }\n  }\n}\n</style>\n"]}]}