{"remainingRequest":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wuzhanfly/git/filscan-frontend/src/views/home/components/chart/BlockSizeChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wuzhanfly/git/filscan-frontend/src/views/home/components/chart/BlockSizeChart.vue","mtime":1612684657988},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEJsb2NTaXplRGF0YSB9IGZyb20gIkAvYXBpL2hvbWUiOwppbXBvcnQgZGF5anMgZnJvbSAiZGF5anMiOwpsZXQgY2hhcnQ7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQmxvY2tTaXplQ2hhcnQiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhTGlzdDogW10sCiAgICAgIGF2Z1NpemU6IDAsCiAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZHJhd1NpemVDaGFydCgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YUxpc3Q7CiAgICAgIGNvbnN0IHsKICAgICAgICBheGlzTGluZSwKICAgICAgICBzZXJpZXNJdGVtLAogICAgICAgIHNlcmllc01hcmtMaW5lCiAgICAgIH0gPSB0aGlzLmNoYXJ0VGhlbWUuYmxvY2tTaXplOwogICAgICBjb25zdCB2bSA9IHRoaXM7CiAgICAgIGNvbnN0IG9wdGlvbiA9IHsKICAgICAgICB4QXhpczogewogICAgICAgICAgZGF0YTogW10sCiAgICAgICAgICBheGlzTGluZTogewogICAgICAgICAgICBsaW5lU3R5bGU6IHsKICAgICAgICAgICAgICBjb2xvcjogYXhpc0xpbmUKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGF4aXNUaWNrOiB7CiAgICAgICAgICAgIHNob3c6IGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB5QXhpczogewogICAgICAgICAgc2hvdzogZmFsc2UKICAgICAgICB9LAogICAgICAgIGdyaWQ6IHsKICAgICAgICAgIGxlZnQ6IDAsCiAgICAgICAgICB0b3A6IDAsCiAgICAgICAgICBib3R0b206IDEwLAogICAgICAgICAgcmlnaHQ6IDAKICAgICAgICB9LAogICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24ocCkgewogICAgICAgICAgICBjb25zdCBodG1sID0gdm0uJHQoImNoYXJ0LmJsb2NrU2l6ZSIsIHsKICAgICAgICAgICAgICB2YWx1ZTogcC5kYXRhLmZvcm1hdFZhbHVlLAogICAgICAgICAgICAgIG5hbWU6IHAubmFtZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGh0bWw7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzZXJpZXM6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogImJhciIsCiAgICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICAgIG5vcm1hbDogewogICAgICAgICAgICAgICAgY29sb3I6IHNlcmllc0l0ZW0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgIG1hcmtMaW5lOiB7CiAgICAgICAgICAgICAgc2lsZW50OiB0cnVlLAogICAgICAgICAgICAgIGxhYmVsOiB7CiAgICAgICAgICAgICAgICBzaG93OiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgbGluZVN0eWxlOiB7CiAgICAgICAgICAgICAgICBjb2xvcjogc2VyaWVzTWFya0xpbmUKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHN5bWJvbDogIm5vbmUiLAogICAgICAgICAgICAgIGRhdGE6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdHlwZTogImF2ZXJhZ2UiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9OwogICAgICBjaGFydC5zZXRPcHRpb24ob3B0aW9uKTsKICAgIH0sCiAgICBhc3luYyBnZXRCbG9ja1NpemVEYXRhKCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0QmxvY1NpemVEYXRhKHRoaXMudGltZSk7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgY29uc3QgeyBkYXRhLCBhdmdfYmxvY2tzaXplIH0gPSByZXM7CiAgICAgICAgY29uc3QgZGF0YUxpc3QgPSBkYXRhLm1hcChpdGVtID0+IHsKICAgICAgICAgIGNvbnN0IGVuZCA9IGRheWpzKGl0ZW0udGltZSAqIDEwMDApCiAgICAgICAgICAgIC5hZGQoMSwgImhvdXIiKQogICAgICAgICAgICAuZm9ybWF0KCJISDptbSIpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbmFtZTogYCR7dGhpcy5mb3JtYXRUaW1lQnlTdHIoCiAgICAgICAgICAgICAgaXRlbS50aW1lICogMTAwMCwKICAgICAgICAgICAgICAiTU1NIERvIFlZWVkgSEg6bW0iCiAgICAgICAgICAgICl9LSR7ZW5kfWAsCiAgICAgICAgICAgIGZvcm1hdFZhbHVlOiB0aGlzLmZvcm1hdE51bWJlcihpdGVtLmJsb2NrX3NpemUpLAogICAgICAgICAgICB2YWx1ZTogaXRlbS5ibG9ja19zaXplCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIHRoaXMuZGF0YUxpc3QgPSBPYmplY3QuZnJlZXplKGRhdGFMaXN0KTsKICAgICAgICB0aGlzLmF2Z1NpemUgPSB0aGlzLmZvcm1hdE51bWJlcihhdmdfYmxvY2tzaXplKTsKICAgICAgICB0aGlzLmRyYXdTaXplQ2hhcnQoKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICBwcm9wczogewogICAgdGltZTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgY2hhcnQgPSB0aGlzLiRjaGFydC5pbml0KHRoaXMuJHJlZnMuc2l6ZSk7CiAgICB0aGlzLmdldEJsb2NrU2l6ZURhdGEoKTsKICB9LAogIHdhdGNoOiB7CiAgICBsYXRlc3RCbG9ja0hlaWdodCgpIHsKICAgICAgaWYgKHRoaXMubG9hZENvdW50ID09PSAxKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuZ2V0QmxvY2tTaXplRGF0YSgpOwogICAgfSwKICAgIHRoZW1lKCkgewogICAgICB0aGlzLmRyYXdTaXplQ2hhcnQoKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["BlockSizeChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BlockSizeChart.vue","sourceRoot":"src/views/home/components/chart","sourcesContent":["<template>\n  <div\n    class=\"block-size-chart\"\n    v-loading=\"loading\"\n    element-loading-background=\"var(--board-bg-color)\"\n  >\n    <div class=\"size-info-con\">\n      <div class=\"top-30\">\n        {{ $t(\"home.blockSize.label\") }}\n        <el-popover\n          placement=\"bottom-start\"\n          width=\"200\"\n          trigger=\"hover\"\n          :content=\"$t('home.blockSize.tips')\"\n        >\n          <i class=\"el-icon-warning-outline\" slot=\"reference\"></i>\n        </el-popover>\n      </div>\n      <div v-show=\"!loading\">\n        {{ $t(\"home.blockSize.size\", { avg: avgSize }) }}\n      </div>\n    </div>\n    <div class=\"chart-con\" ref=\"size\"></div>\n  </div>\n</template>\n<script>\nimport { getBlocSizeData } from \"@/api/home\";\nimport dayjs from \"dayjs\";\nlet chart;\nexport default {\n  name: \"BlockSizeChart\",\n  data() {\n    return {\n      dataList: [],\n      avgSize: 0,\n      loading: false\n    };\n  },\n  methods: {\n    drawSizeChart() {\n      const data = this.dataList;\n      const {\n        axisLine,\n        seriesItem,\n        seriesMarkLine\n      } = this.chartTheme.blockSize;\n      const vm = this;\n      const option = {\n        xAxis: {\n          data: [],\n          axisLine: {\n            lineStyle: {\n              color: axisLine\n            }\n          },\n          axisTick: {\n            show: false\n          }\n        },\n        yAxis: {\n          show: false\n        },\n        grid: {\n          left: 0,\n          top: 0,\n          bottom: 10,\n          right: 0\n        },\n        tooltip: {\n          formatter: function(p) {\n            const html = vm.$t(\"chart.blockSize\", {\n              value: p.data.formatValue,\n              name: p.name\n            });\n            return html;\n          }\n        },\n        series: [\n          {\n            type: \"bar\",\n            itemStyle: {\n              normal: {\n                color: seriesItem\n              }\n            },\n            data: data,\n            markLine: {\n              silent: true,\n              label: {\n                show: false\n              },\n              lineStyle: {\n                color: seriesMarkLine\n              },\n              symbol: \"none\",\n              data: [\n                {\n                  type: \"average\"\n                }\n              ]\n            }\n          }\n        ]\n      };\n      chart.setOption(option);\n    },\n    async getBlockSizeData() {\n      try {\n        this.loading = true;\n        const res = await getBlocSizeData(this.time);\n        this.loading = false;\n        const { data, avg_blocksize } = res;\n        const dataList = data.map(item => {\n          const end = dayjs(item.time * 1000)\n            .add(1, \"hour\")\n            .format(\"HH:mm\");\n          return {\n            name: `${this.formatTimeByStr(\n              item.time * 1000,\n              \"MMM Do YYYY HH:mm\"\n            )}-${end}`,\n            formatValue: this.formatNumber(item.block_size),\n            value: item.block_size\n          };\n        });\n        this.dataList = Object.freeze(dataList);\n        this.avgSize = this.formatNumber(avg_blocksize);\n        this.drawSizeChart();\n      } catch (e) {\n        this.loading = false;\n      }\n    }\n  },\n  props: {\n    time: {\n      type: Object,\n      default() {\n        return {};\n      }\n    }\n  },\n  mounted() {\n    chart = this.$chart.init(this.$refs.size);\n    this.getBlockSizeData();\n  },\n  watch: {\n    latestBlockHeight() {\n      if (this.loadCount === 1) {\n        return;\n      }\n      this.getBlockSizeData();\n    },\n    theme() {\n      this.drawSizeChart();\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.block-size-chart {\n  display: flex;\n  .size-info-con {\n    min-width: 200px;\n    div:last-child {\n      font-size: 26px;\n      color: var(--block-size-color);\n      margin-top: 5px;\n    }\n    div:first-child {\n      font-weight: bold;\n      height: 30px;\n      color: var(--total-board-top-color);\n      &::before {\n        content: \"\";\n        display: inline-block;\n        width: 12px;\n        height: 12px;\n        background: var(--block-size-color);\n        border-radius: 50%;\n        margin-right: 5px;\n      }\n    }\n  }\n  .chart-con {\n    flex: 1;\n    height: 100%;\n  }\n  @media (max-width: 768px) {\n    .size-info-con {\n      flex: 2;\n    }\n    .size-info-con > div:last-child {\n      margin-top: 25px !important;\n      font-size: 12px !important;\n    }\n    .size-info-con > div:first-child::before {\n      width: 6px;\n      height: 6px;\n    }\n    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.03);\n    border-radius: 4px;\n    .chart-con {\n      flex: 3;\n    }\n  }\n}\n</style>\n"]}]}