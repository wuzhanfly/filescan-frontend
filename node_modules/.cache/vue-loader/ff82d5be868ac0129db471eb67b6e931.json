{"remainingRequest":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/wuzhanfly/git/filscan-frontend/src/views/home/components/chart/BlockTimeChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/wuzhanfly/git/filscan-frontend/src/views/home/components/chart/BlockTimeChart.vue","mtime":1612684657988},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/wuzhanfly/git/filscan-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEJsb2NrVGltZURhdGEgfSBmcm9tICJAL2FwaS9ob21lIjsKaW1wb3J0IGRheWpzIGZyb20gImRheWpzIjsKbGV0IGNoYXJ0OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkJsb2NrVGltZUNoYXJ0IiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YUxpc3Q6IFtdLAogICAgICBhdmdUaW1lOiAwLAogICAgICBtaW46IDAsCiAgICAgIG1heDogMCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHNob3VsZFJlc3BvbmRUaGVtZUNoYW5nZTogdHJ1ZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRyYXdUaW1lQ2hhcnQoKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGFMaXN0OwogICAgICBjb25zdCB7CiAgICAgICAgYXhpc0xpbmUsCiAgICAgICAgc2VyaWVzSXRlbSwKICAgICAgICBzZXJpZXNNYXJrTGluZQogICAgICB9ID0gdGhpcy5jaGFydFRoZW1lLmJsb2NrVGltZTsKICAgICAgY29uc3Qgdm0gPSB0aGlzOwogICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgZm9ybWF0dGVyOiBmdW5jdGlvbihwKSB7CiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSB2bS4kdCgiY2hhcnQuYmxvY2tUaW1lIiwgewogICAgICAgICAgICAgIHZhbHVlOiBwLnZhbHVlLAogICAgICAgICAgICAgIG5hbWU6IHAubmFtZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGh0bWw7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBncmlkOiB7CiAgICAgICAgICBsZWZ0OiAwLAogICAgICAgICAgdG9wOiAwLAogICAgICAgICAgcmlnaHQ6IDAsCiAgICAgICAgICBib3R0b206IDEwCiAgICAgICAgfSwKICAgICAgICB4QXhpczogewogICAgICAgICAgZGF0YTogW10sCiAgICAgICAgICBheGlzVGljazogewogICAgICAgICAgICBzaG93OiBmYWxzZQogICAgICAgICAgfSwKICAgICAgICAgIGF4aXNMaW5lOiB7CiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIGxpbmVTdHlsZTogewogICAgICAgICAgICAgIGNvbG9yOiBheGlzTGluZQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB5QXhpczogewogICAgICAgICAgc2hvdzogZmFsc2UKICAgICAgICB9LAogICAgICAgIHNlcmllczogWwogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAiYmFyIiwKICAgICAgICAgICAgaXRlbVN0eWxlOiB7CiAgICAgICAgICAgICAgbm9ybWFsOiB7CiAgICAgICAgICAgICAgICBjb2xvcjogc2VyaWVzSXRlbQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgbWFya0xpbmU6IHsKICAgICAgICAgICAgICBzaWxlbnQ6IHRydWUsCiAgICAgICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBsaW5lU3R5bGU6IHsKICAgICAgICAgICAgICAgIGNvbG9yOiBzZXJpZXNNYXJrTGluZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgc3ltYm9sOiAibm9uZSIsCiAgICAgICAgICAgICAgZGF0YTogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICB0eXBlOiAiYXZlcmFnZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH07CiAgICAgIGNoYXJ0LnNldE9wdGlvbihvcHRpb24pOwogICAgfSwKICAgIGFzeW5jIGdldEJsb2NrVGltZURhdGEoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRCbG9ja1RpbWVEYXRhKHRoaXMudGltZSk7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgY29uc3QgeyBkYXRhLCBtaW4sIG1heCwgYXZnX2Jsb2NrdGltZSB9ID0gcmVzOwogICAgICAgIGNvbnN0IGRhdGFMaXN0ID0gZGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgICBjb25zdCBlbmQgPSBkYXlqcyhpdGVtLnRpbWUgKiAxMDAwKQogICAgICAgICAgICAuYWRkKDEsICJob3VyIikKICAgICAgICAgICAgLmZvcm1hdCgiSEg6bW0iKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG5hbWU6IGAke3RoaXMuZm9ybWF0VGltZUJ5U3RyKAogICAgICAgICAgICAgIGl0ZW0udGltZSAqIDEwMDAsCiAgICAgICAgICAgICAgIk1NTSBEbyBZWVlZIEhIOm1tIgogICAgICAgICAgICApfS0ke2VuZH1gLAogICAgICAgICAgICB2YWx1ZTogaXRlbS5ibG9ja190aW1lCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICAgIHRoaXMuZGF0YUxpc3QgPSBPYmplY3QuZnJlZXplKGRhdGFMaXN0KTsKICAgICAgICB0aGlzLmF2Z1RpbWUgPSBNYXRoLmZsb29yKGF2Z19ibG9ja3RpbWUpOwogICAgICAgIHRoaXMubWluID0gbWluOwogICAgICAgIHRoaXMubWF4ID0gbWF4OwogICAgICAgIHRoaXMuZHJhd1RpbWVDaGFydCgpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LAogIHByb3BzOiB7CiAgICB0aW1lOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBjaGFydCA9IHRoaXMuJGNoYXJ0LmluaXQodGhpcy4kcmVmcy50aW1lKTsKICAgIHRoaXMuZ2V0QmxvY2tUaW1lRGF0YSgpOwogIH0sCiAgd2F0Y2g6IHsKICAgIGxhdGVzdEJsb2NrSGVpZ2h0KCkgewogICAgICB7CiAgICAgICAgaWYgKHRoaXMubG9hZENvdW50ID09PSAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuZ2V0QmxvY2tUaW1lRGF0YSgpOwogICAgICB9CiAgICB9LAogICAgdGhlbWUoKSB7CiAgICAgIHRoaXMuZHJhd1RpbWVDaGFydCgpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["BlockTimeChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BlockTimeChart.vue","sourceRoot":"src/views/home/components/chart","sourcesContent":["<template>\n  <div\n    class=\"block-time-chart\"\n    v-loading=\"loading\"\n    element-loading-background=\"var(--board-bg-color)\"\n  >\n    <div class=\"chart-top\">\n      <div class=\"avg top-30\">\n        <div>\n          {{ $t(\"home.blockTime.label\") }}\n          <el-popover\n            placement=\"bottom-start\"\n            width=\"200\"\n            trigger=\"hover\"\n            :content=\"$t('home.blockTime.tips')\"\n          >\n            <i class=\"el-icon-warning-outline\" slot=\"reference\"></i>\n          </el-popover>\n        </div>\n        <div v-show=\"!loading\">{{ avgTime }} s</div>\n      </div>\n      <div class=\"chart-con\" ref=\"time\"></div>\n    </div>\n    <div class=\"min-max bottom-10\">\n      <div class=\"min\">\n        <span>{{ $t(\"home.blockTime.min\") }}</span>\n        <span>{{ min }} s</span>\n      </div>\n      <div class=\"max\">\n        <span>{{ $t(\"home.blockTime.max\") }}</span>\n        <span>{{ max }} s</span>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { getBlockTimeData } from \"@/api/home\";\nimport dayjs from \"dayjs\";\nlet chart;\nexport default {\n  name: \"BlockTimeChart\",\n  data() {\n    return {\n      dataList: [],\n      avgTime: 0,\n      min: 0,\n      max: 0,\n      loading: false,\n      shouldRespondThemeChange: true\n    };\n  },\n  methods: {\n    drawTimeChart() {\n      const data = this.dataList;\n      const {\n        axisLine,\n        seriesItem,\n        seriesMarkLine\n      } = this.chartTheme.blockTime;\n      const vm = this;\n      const option = {\n        tooltip: {\n          formatter: function(p) {\n            const html = vm.$t(\"chart.blockTime\", {\n              value: p.value,\n              name: p.name\n            });\n            return html;\n          }\n        },\n        grid: {\n          left: 0,\n          top: 0,\n          right: 0,\n          bottom: 10\n        },\n        xAxis: {\n          data: [],\n          axisTick: {\n            show: false\n          },\n          axisLine: {\n            show: true,\n            lineStyle: {\n              color: axisLine\n            }\n          }\n        },\n        yAxis: {\n          show: false\n        },\n        series: [\n          {\n            type: \"bar\",\n            itemStyle: {\n              normal: {\n                color: seriesItem\n              }\n            },\n            data: data,\n            markLine: {\n              silent: true,\n              label: {\n                show: false\n              },\n              lineStyle: {\n                color: seriesMarkLine\n              },\n              symbol: \"none\",\n              data: [\n                {\n                  type: \"average\"\n                }\n              ]\n            }\n          }\n        ]\n      };\n      chart.setOption(option);\n    },\n    async getBlockTimeData() {\n      try {\n        this.loading = true;\n        const res = await getBlockTimeData(this.time);\n        this.loading = false;\n        const { data, min, max, avg_blocktime } = res;\n        const dataList = data.map(item => {\n          const end = dayjs(item.time * 1000)\n            .add(1, \"hour\")\n            .format(\"HH:mm\");\n          return {\n            name: `${this.formatTimeByStr(\n              item.time * 1000,\n              \"MMM Do YYYY HH:mm\"\n            )}-${end}`,\n            value: item.block_time\n          };\n        });\n        this.dataList = Object.freeze(dataList);\n        this.avgTime = Math.floor(avg_blocktime);\n        this.min = min;\n        this.max = max;\n        this.drawTimeChart();\n      } catch (e) {\n        this.loading = false;\n      }\n    }\n  },\n  props: {\n    time: {\n      type: Object,\n      default() {\n        return {};\n      }\n    }\n  },\n  mounted() {\n    chart = this.$chart.init(this.$refs.time);\n    this.getBlockTimeData();\n  },\n  watch: {\n    latestBlockHeight() {\n      {\n        if (this.loadCount === 1) {\n          return;\n        }\n        this.getBlockTimeData();\n      }\n    },\n    theme() {\n      this.drawTimeChart();\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.block-time-chart {\n  .chart-top {\n    display: flex;\n  }\n  .avg {\n    min-width: 180px;\n    div:first-child {\n      font-weight: bold;\n      height: 30px;\n      color: var(--total-board-top-color);\n      &::before {\n        content: \"\";\n        display: inline-block;\n        width: 12px;\n        height: 12px;\n        background: #0091ff;\n        border-radius: 50%;\n        margin-right: 5px;\n      }\n    }\n    div:last-child {\n      color: #0091ff;\n      font-size: 26px;\n      margin-top: 5px;\n    }\n  }\n  .chart-con {\n    height: 100px;\n    flex: 1;\n  }\n  .min-max {\n    margin-left: 180px;\n    display: flex;\n    justify-content: space-between;\n    flex: 1;\n    .min,\n    .max {\n      font-size: 16px;\n      span:first-child {\n        color: var(--total-board-bottom-color);\n        margin-right: 10px;\n      }\n      span:last-child {\n        color: var(--main-text-color);\n      }\n    }\n    .max {\n      span:first-child {\n        color: #ff0044;\n      }\n    }\n  }\n  @media (max-width: 768px) {\n    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.03);\n    border-radius: 4px;\n    .avg {\n      flex: 2;\n      div:last-child {\n        margin-top: 15px !important;\n        font-size: 12px !important;\n      }\n      & div:first-child::before {\n        width: 6px;\n        height: 6px;\n      }\n    }\n    .chart-con {\n      flex: 3;\n    }\n    .min-max {\n      padding-left: 40%;\n      margin: 0;\n    }\n    .min,\n    .max {\n      font-size: 12px !important;\n    }\n  }\n}\n</style>\n"]}]}